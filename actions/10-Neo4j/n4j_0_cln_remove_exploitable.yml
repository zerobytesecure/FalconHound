Name: CLEANUP - Remove exploitable attribute after 45 days
ID: N4J_CLN_Remove_Old_Exploitable
Description: Removes the Exploitable flags if the exploitableSince is older than 45 days.
Author: FalconForce
Version: '1.0'
Info: |
    We assume a 30 day patch cycle and 15 days grace period. If the exploitableSince is older than 45 days, we remove the exploitable flag.
    Should the machine not be patched yet the timestamp should be updated by the Exploitable Hosts action.
Active: true                 # Enable to run this action
Debug: false                  # Enable to see query results in the console
SourcePlatform: Neo4j 
Query: |
    MATCH (c {exploitable:true})
    WHERE duration.between(datetime(c.exploitableSince), datetime()).days > 45
    REMOVE c.exploitable, c.exploits, c.exploitableSince
Targets: []